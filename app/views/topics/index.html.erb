<h1>Topics</h1>
<hr />

<% if policy(Topic.new).create? %>
  <div class = "col-md-4">
    <%= link_to "New Topic", new_topic_path, class: 'btn btn-success' %>
  </div>
<% end %>

<div class = "row">
  <div class = "col-md-8">
    <% @topics.each do |topic| %>
      <div class = "media">
        <div class = "media-body">
          <h4 class = "media-heading">
            <%= link_to "##{topic.title}", topic_path %>
          </h4>
          <% if policy(Topic.new).edit? %>
            <%= link_to "edit", edit_topic_path %>
            <%= link_to "destroy", topic, method: :delete, data: { confirm: 'Are you sure you want to delete this topic? Deleting a topic will delete all associated bookmarks.' } %>
          <% end %>
          <br />
          <% topic.bookmarks.each do |bookmark| %>
            <%= render partial: 'likes/like', locals: { bookmark: bookmark } %>
            <%= link_to "#{bookmark.url}", "#{bookmark.url}", target: "_blank" %>
            <% if policy(bookmark).update? %>
              <%= link_to "edit", edit_bookmark_path(bookmark), class: 'btn btn-danger' %>
              <%= link_to "destroy", [bookmark], method: :delete, data: { confirm: 'Are you sure you want to delete this bookmark?' }, class: 'btn btn-danger' %>
            <% end %>
            <br />
          <% end %>
        </div>
      </div>
    <% end %>
  </div>
</div>
